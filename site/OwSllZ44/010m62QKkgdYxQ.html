<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />

        <title>Ненавижу</title>

        <link
            rel="icon"
            href="./images/НЕПРИКОСНОВЕННА.jpg"
            type="image/x-icon"
        />
        <link
            rel="shortcut icon"
            href="./images/НЕПРИКОСНОВЕННА.jpg"
            type="image/x-icon"
        />

        <link rel="stylesheet" href="./css/style.css" />
    </head>

    <body>
        <div id="div-settings" class="z-4">
            <label>
                <input type="color" id="pen_color" value="#000000" /><span
                    class="me-1"
                    >Fill</span
                >
            </label>
            <!-- <label class="me-2">
            <input type="color" id="back_color" value="#FFFFFF"><span class="me-1">Back</span>
        </label> -->
        </div>

        <div id="div-photo">
            <button id="btn-click" class="z-4" onclick="clickButton()" disabled>
                Портрет госпожи Лизы дель Джокондо
            </button>
            <img
                id="img-portrait"
                class="not-allowed-image z-1"
                src="./images/Я БУДУ ПОМНИТЬ ТЕБЯ.png"
                alt="Я БУДУ ПОМНИТЬ ТЕБЯ"
                crossorigin="anonymous"
            />
        </div>

        <!-- <canvas id="backgroundCanvas" class="z-1"></canvas> -->
        <canvas id="imageCanvas" class="z-3"></canvas>
    </body>

    <style>
        :root {
            cursor: text;
        }

        span {
            /* mix-blend-mode: difference; */
            color: white;
            font-size: var(--font-size);
        }

        canvas {
            position: absolute;
        }

        /* 
    
    
        */

        #div-settings {
            position: absolute;
            margin: 0;
            padding: 1% 0;
            top: 0;
            background-color: blue;
            width: 100%;
            display: flex;
            justify-content: center;
        }

        #div-photo {
            position: absolute;
            width: 40vw;
            height: auto;
            display: block;
            margin: 0;
            align-self: center;
        }

        #img-portrait {
            position: relative;
            width: 100%;
            height: auto;
            opacity: 1;
            border-radius: 7.5px;
        }

        #btn-click {
            position: absolute;
            width: 125%;
            top: 105%;
            left: 50%;
            transform: translate(-50%, -50%);
            cursor: pointer;
            font-size: var(--font-size-sm);
        }

        @media (min-width: 768px) {
            #div-settings {
                /* margin: 10% !important; */
            }

            #div-photo {
                width: 35vw;
            }

            #btn-click {
                width: 80%;
                top: 105%;
            }
        }

        @media (min-width: 1024px) {
            #div-settings {
                /* margin: 2% !important; */
            }

            #div-photo {
                width: 30vw;
            }

            #btn-click {
                width: 90%;
                top: 105%;
            }
        }

        @media (min-width: 1280px) {
            #div-settings {
                /* margin: 1% !important; */
            }

            #div-photo {
                width: 25vw;
            }

            #btn-click {
                width: 80%;
                top: 105%;
            }
        }

        @media (min-width: 1440px) {
            #div-settings {
                /* margin: 2% !important; */
            }

            #div-photo {
                width: 25vw;
            }

            #btn-click {
                width: 80%;
                top: 103%;
            }
        }

        @media (min-width: 1600px) {
            #div-settings {
                /* margin: 2% !important; */
            }

            #div-photo {
                width: 20vw;
            }

            #btn-click {
                width: 90%;
                top: 103%;
            }
        }

        @media (min-width: 1920px) {
            #div-settings {
                /* margin: 0 !important; */
            }

            #div-photo {
                width: 20vw;
            }

            #btn-click {
                width: 80%;
                top: 103%;
            }
        }
    </style>

    <script src="/src/jquery-3.7.1.min.js"></script>
    <script src="/src/html2canvas.min.js"></script>
    <script src="/js/screenshot.js"></script>
    <script type="text/javascript">
        $("body").hide();
        $(document).ready(function () {
            $("body").show();
        });

        //
        //
        //

        const PADDING_CANVAS = 0;
        const CANVAS = document.getElementById("imageCanvas");
        // const BG_CANVAS = document.getElementById('backgroundCanvas');
        const PEN_COLOR = document.getElementById("pen_color");
        // const BACK_COLOR = document.getElementById("back_color")

        var IS_CANVAS_BLANK = true;
        var intervalId = setInterval(() => {
            if (!IS_CANVAS_BLANK) {
                clearInterval(intervalId);
                return;
            }
            IS_CANVAS_BLANK = isCanvasBlank();
            if (!IS_CANVAS_BLANK) $("#btn-click").attr("disabled", false);
        }, 250);

        //
        //
        //

        const NAME_SCRENSHOT = "Портрет госпожи Лизы дель Джокондо";

        // window.addEventListener("beforeunload", function (event) {
        //     event.preventDefault();
        //     e.returnValue = "Файл будет скачан перед закрытием";

        //     $("#div-settings").css("display", "none");
        //     captureScreenshot();
        // });

        async function clickButton() {
            $("#div-settings").css("display", "none");
            await captureScreenshot();
            $("#div-settings").css("display", "flex");
        }
    </script>
    <script src="./js/cursorPaint.js"></script>
</html>
